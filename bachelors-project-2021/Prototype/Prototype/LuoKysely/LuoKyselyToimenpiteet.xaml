<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Prototype.LuoKyselyToimenpiteet"
             Title="Luo kysely 3/3">


    <AbsoluteLayout
        Padding="0"
        HorizontalOptions="FillAndExpand"
        VerticalOptions="FillAndExpand">
        <StackLayout Margin="20"
                       AbsoluteLayout.LayoutBounds="0, 0, 1, 1"
            AbsoluteLayout.LayoutFlags="All">
        
        <Label Margin="0,0,0,15"
               Text="Aseta toimenpiteet"
               TextColor="Black"
               FontSize="20"/>

        <CollectionView 
            HorizontalOptions="CenterAndExpand" 
            VerticalOptions="CenterAndExpand"
          
            HeightRequest="470" 
            ItemsSource="{Binding Emojit} "  >

            <CollectionView.ItemTemplate >
                <DataTemplate >
                        <Grid Padding="2"
                      RowDefinitions="Auto, *"
                      ColumnDefinitions="Auto, *">


                            <Image Grid.RowSpan="1"
                           Source="{Binding Item.ImageSource}"     
                           Aspect="AspectFill"
                           HeightRequest="60"
                           WidthRequest="60" />

                         
                            <!-- Dropdown menu placeholder-->



                            <!-- Button for drop down menu -->
                            <Button Grid.Column="1"
                            
                                Margin="20,20,20,0"
                                VerticalOptions="Center"
                                HorizontalOptions="Center"
                                WidthRequest="300"
                                HeightRequest="50"
                                Clicked="btnPopupButton_Clicked"
                 
                                Text="Valitse toimenpide"    /> 
                         

                        </Grid>

                    </DataTemplate>
                
                
            </CollectionView.ItemTemplate>

                    
        </CollectionView>





        <!-- "Lisää toimenpide" drop down menu -->
        <!-- "Ongelma: EI yhteydessä eri painikkeeseen. Eli ihan sama mitä painiketta painaa, valinnat ovat aina samat
              Pitäisi jotenkin saada tämä sisällytettyä samaan Collectionviewiin kuin button, jotta tämä ratkeaisi... ei vielää tietoa  miten. Ehkä erilainen popup ratkaisu-->

        <!--  Popup Area  -->

          
        <Frame
           
            AbsoluteLayout.LayoutBounds="0, 0, 1, 1"
            AbsoluteLayout.LayoutFlags="All"
            x:Name="popupSelection"
            HasShadow="True"
             WidthRequest="290"
            HeightRequest="400"
            Padding="1"
            BackgroundColor="WhiteSmoke" 
            IsVisible="false">

            <StackLayout HorizontalOptions="Center" VerticalOptions="Center" >
                    <StackLayout
                
                    HeightRequest="400"
                    Orientation="Vertical"
                    WidthRequest="260">
                        
                        <CollectionView x:Name="Collection" 
                        ItemsSource= "{Binding Activities}"
                        SelectionMode= "Multiple" 
                        SelectionChanged="OnSelectionChanged" >
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                               

                                        <Label Grid.Column="1"
                                               Text="{Binding activity}" 
                                               TextColor="Black"
                                               FontSize="20"/>

                             
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                        
                    <AbsoluteLayout Margin="15"  VerticalOptions ="End" HorizontalOptions="Center">
                        <Button  
                             CornerRadius="100"
                            
                             WidthRequest="150"
                            Text="Sulje"
                            Clicked="Sulje_Clicked"/>
                    </AbsoluteLayout>
                </StackLayout>

                </StackLayout>

            </Frame> 

            <!--  Popup Area end  -->
        <!-- "Lisää toimenpide" Drop down menu end -->



        <!-- "Jatka" Button -->
        <AbsoluteLayout Margin="15"  VerticalOptions ="EndAndExpand" HorizontalOptions="CenterAndExpand">
            <Button Text="Jatka"
                Clicked="JatkaButtonClicked" 
                CornerRadius="100"
                HorizontalOptions="Center"
                WidthRequest="150"
                HeightRequest="50"/>
        </AbsoluteLayout>
        
    </StackLayout>

    </AbsoluteLayout>
</ContentPage>